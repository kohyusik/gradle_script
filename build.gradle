import org.apache.tools.ant.filters.ReplaceTokens

/*
 * This file was generated by the Gradle 'init' task.
 *
 * This is a general purpose Gradle build.
 * Learn how to create Gradle builds at https://guides.gradle.org/creating-new-gradle-builds/
 */
apply plugin: 'java'

//for Ant filter

//for including in the copy task
def dataContent = copySpec {
    from 'src/data'
    include '*.data'
}

//task initConfig(type: Copy) {
//    from('src/main/config') {
//        include '**/*.properties'
//        include '**/*.xml'
//        filter(ReplaceTokens, tokens: [version: '2.3.1'])
//    }
//    from('src/main/config') {
//        exclude '**/*.properties', '**/*.xml'
//    }
//    from('src/main/languages') {
//        rename 'EN_US_(.*)', '$1'
//    }
//    into 'build/target/config'
//    exclude '**/*.bak'
//
//    includeEmptyDirs = false
//
//    with dataContent
//}

task copyTask(type: Copy) {

    def properties = new Properties()
    file('conf/build.properties').withInputStream {
        properties.load(it)
        println properties
    }

    from('sample_script') {
        include '**/*.sh'
        rename (/(.+)-sample/, '$1')
    }
    into 'build/libs/bin'

//    filter(ReplaceTokens, tokens: properties)

    filter(ReplaceTokens, tokens: properties)
//    filter(ReplaceTokens, tokens: [copyright:'2009', version:'2.3.1'])

}

build.finalizedBy(copyTask)